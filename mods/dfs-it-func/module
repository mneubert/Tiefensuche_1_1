module

  export 
    
      digraph-dfs-func

  refinement
    representation of operations  

      deptSearchF# implements deptSearchF;

    implementation

    import 

     	digraph-path


    variables 
		open : list;
		close : list;
		bbool : bool;
		path : list;
     
    declaration


 deptSearchF#(a, z, g; y)
         begin	
	var open =  [] + a , close =  [], n0 = 0, a0 = a, path = [], bbool = false
	in 
	  begin 
	    y := [] ;
            n0 := getM( a , g );
              if µ(a ' = [] ¹ z = []) then
              begin
                  if a ² z then
		  begin
	            bbool := true;
                    y := a '       
		  end
                  else
                  begin
                  path := a ' ;
                  while n0 > 0  ¸ bbool = false ¸ open Ü [] do
	          begin
		    	a0 := open .first ;
                        path := path + a0 ' ;
			if a0 ² z then
		    	begin
	              	       bbool := true ;    
		    	end
			else
			begin
                        n0 := n0 - 1 ;
                    	close := a0 ' + close;
                    	open :=  set2list(outsortSuccs(a0, list2set(close), g)) + open.rest;
			end
                  end;
		  if n0 = 0 then
		  begin 
			y := []
		  end
		  else
                  begin
		  	y := path
		  end
                end
              end
	  end		
	end


end module